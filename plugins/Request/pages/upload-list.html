<!-- Página para Upload de Arquivo para Nova Campanha -->
<div class="container mt-5">
    <div class="p-4 rounded bg-dark text-light shadow">
        <h3>Upload de Arquivo para Nova Campanha</h3>
        <p>Carregue arquivos para criar uma nova campanha. Você pode enviar uma lista de números (.csv ou .txt) e/ou um
            arquivo de áudio (.mp3, .wav).</p>

        <!-- Formulário de Upload -->
        <form enctype="multipart/form-data" id="uploadFilesForm" onsubmit="return handleFileUpload(event)">
            <div class="mb-3">
                <label class="form-label" for="campaignName">Nome da Campanha</label>
                <input class="form-control" id="campaignName" placeholder="Digite o nome da campanha" required
                       type="text">
            </div>

            <div class="mb-3">
                <label class="form-label" for="numbersFileInput">Arquivo de Números</label>
                <input accept=".csv, .txt" class="form-control" id="numbersFileInput" type="file">
                <div class="form-text">Envie um arquivo no formato .csv ou .txt com uma lista de números separados por
                    linha.
                </div>
            </div>

            <div class="mb-3">
                <label class="form-label" for="audioFileInput">Arquivo de Áudio</label>
                <input accept=".mp3, .wav" class="form-control" id="audioFileInput" type="file">
                <div class="form-text">Envie um arquivo de áudio no formato .mp3 ou .wav para usar na campanha.</div>
            </div>

            <div class="mb-3">
                <button class="btn btn-primary" type="submit">Criar Campanha</button>
                <button class="btn btn-secondary" onclick="resetForm()" type="button">Cancelar</button>
            </div>
        </form>

        <!-- Indicador de progresso -->
        <div class="mt-3" id="uploadProgress" style="display: none;">
            <div class="progress">
                <div aria-valuemax="100" aria-valuemin="0"
                     aria-valuenow="0" class="progress-bar progress-bar-striped progress-bar-animated"
                     role="progressbar" style="width: 0%;"></div>
            </div>
            <p class="mt-2" id="progressText">Carregando arquivos...</p>
        </div>

        <!-- Mensagens de feedback -->
        <div class="mt-3" id="uploadFeedback" style="display: none;">
            <!-- Mensagem preenchida dinamicamente -->
        </div>
    </div>
</div>

<script>
    // Função para lidar com o envio do formulário
    function handleFileUpload(event) {
        event.preventDefault();
        const form = document.getElementById('uploadFilesForm');
        const campaignName = document.getElementById('campaignName').value.trim();
        const numbersFileInput = document.getElementById('numbersFileInput').files[0];
        const audioFileInput = document.getElementById('audioFileInput').files[0];
        const progressBar = document.querySelector('.progress-bar');
        const uploadProgress = document.getElementById('uploadProgress');
        const uploadFeedback = document.getElementById('uploadFeedback');

        if (!campaignName) {
            uploadFeedback.style.display = 'block';
            uploadFeedback.innerHTML = '<div class="alert alert-danger">Por favor, insira um nome para a campanha.</div>';
            return;
        }

        if (!numbersFileInput && !audioFileInput) {
            uploadFeedback.style.display = 'block';
            uploadFeedback.innerHTML = '<div class="alert alert-danger">Por favor, envie pelo menos um arquivo de números ou de áudio.</div>';
            return;
        }

        // Reseta mensagens anteriores
        uploadFeedback.style.display = 'none';
        uploadProgress.style.display = 'block';
        progressBar.style.width = '0%';

        // Simulação de upload
        const fakeUpload = setInterval(() => {
            let currentWidth = parseInt(progressBar.style.width);
            if (currentWidth >= 100) {
                clearInterval(fakeUpload);
                uploadProgress.style.display = 'none';
                uploadFeedback.style.display = 'block';
                uploadFeedback.innerHTML = `<div class="alert alert-success">Campanha "${campaignName}" criada com sucesso!</div>`;
            } else {
                progressBar.style.width = (currentWidth + 10) + '%';
                progressBar.setAttribute('aria-valuenow', currentWidth + 10);
            }
        }, 300);
    }

    // Função para resetar o formulário
    function resetForm() {
        document.getElementById('uploadFilesForm').reset();
        document.getElementById('uploadProgress').style.display = 'none';
        document.getElementById('uploadFeedback').style.display = 'none';
    }
</script>
